<application>
  <component name="YouTrack Issues">
    <option name="persistentIssues">
      <map>
        <entry key="bpm_engine p.nikulshin@https://balance.myjetbrains.com/youtrack" value="[{&quot;id&quot;:&quot;ARGS-661&quot;,&quot;entityId&quot;:&quot;86-58907&quot;,&quot;jiraId&quot;:null,&quot;field&quot;:[{&quot;name&quot;:&quot;projectShortName&quot;,&quot;value&quot;:&quot;ARGS&quot;},{&quot;name&quot;:&quot;summary&quot;,&quot;value&quot;:&quot;Статистика Выдачи&quot;},{&quot;name&quot;:&quot;reporterFullName&quot;,&quot;value&quot;:&quot;Игорь Маркин&quot;},{&quot;name&quot;:&quot;created&quot;,&quot;value&quot;:&quot;1565964040130&quot;},{&quot;name&quot;:&quot;numberInProject&quot;,&quot;value&quot;:&quot;661&quot;},{&quot;name&quot;:&quot;description&quot;,&quot;value&quot;:&quot;&lt;div class=\&quot;wiki text prewrapped\&quot;&gt;сделать таблицы&lt;br/&gt;&lt;strong&gt;по выданным кредитам&lt;/strong&gt;&lt;br/&gt;1. Request_id&lt;br/&gt;2. Статус (выдан, отмена)&lt;br/&gt;2. Сумма кредита&lt;br/&gt;3. Дата выдачи&lt;br/&gt;&lt;br/&gt;&lt;strong&gt;по выданным доп.продуктам&lt;/strong&gt;&lt;br/&gt;1. id допа&lt;br/&gt;2. Статус (выдано, отмена)&lt;br/&gt;3. request id&lt;br/&gt;4. Сумма допа&lt;br/&gt;5. Тип продукта&lt;br/&gt;6. Признак Банк или нет&lt;br/&gt;&lt;br/&gt;Таблицы будут синхронизоваться с Актами/Бордеро. Остальную инфу будем брать из ВРМ или ПП&lt;br/&gt;&lt;br/&gt;&lt;hr/&gt;&lt;br/&gt;сделать View&lt;br/&gt;&lt;strong&gt;Выдачи&lt;/strong&gt;&lt;br/&gt;Каждая запись - агрегированная информация по дням - по таблицам выше&lt;br/&gt;&lt;br/&gt;&lt;ul class=\&quot;wiki-list0\&quot;&gt;&lt;li&gt; Кол-во Залоговых кредитов&lt;br/&gt;&lt;/li&gt;&lt;li&gt; Кол-во БезЗалоговых&lt;br/&gt;&lt;/li&gt;&lt;li&gt; кол-во Новых ТС&lt;br/&gt;&lt;/li&gt;&lt;li&gt; кол-во БУ ТС&lt;br/&gt;&lt;/li&gt;&lt;li&gt; кол-во Офиц. салонов&lt;br/&gt;&lt;/li&gt;&lt;li&gt; кол-во Неофициальных&lt;br/&gt;&lt;/li&gt;&lt;li&gt; кол-во ВКаско&lt;br/&gt;&lt;/li&gt;&lt;li&gt; кол-во СЖ банка&lt;br/&gt;&lt;/li&gt;&lt;li&gt; кол-во Серв.карта банка&lt;br/&gt;&lt;/li&gt;&lt;li&gt; кол-во GAP банка&lt;br/&gt;&lt;br/&gt;&lt;/li&gt;&lt;li&gt; Сумма Залоговых кредитов&lt;br/&gt;&lt;/li&gt;&lt;li&gt; Сумма БезЗалоговых кредитов&lt;br/&gt;&lt;/li&gt;&lt;li&gt; Сумма доп.продуктов банка&lt;br/&gt;&lt;/li&gt;&lt;li&gt; Сумма доп.продуктов не банка&lt;br/&gt;&lt;/li&gt;&lt;li&gt; Сумма ВКаско&lt;br/&gt;&lt;/li&gt;&lt;li&gt; Сумма СЖ банка&lt;br/&gt;&lt;/li&gt;&lt;li&gt; Сумма Серв.карта банка&lt;br/&gt;&lt;/li&gt;&lt;li&gt; Сумма GAP банка&lt;br/&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;\n&quot;},{&quot;name&quot;:&quot;updaterFullName&quot;,&quot;value&quot;:&quot;Павел Никульшин&quot;},{&quot;name&quot;:&quot;reporterName&quot;,&quot;value&quot;:&quot;i.markin&quot;},{&quot;name&quot;:&quot;commentsCount&quot;,&quot;value&quot;:&quot;2&quot;},{&quot;name&quot;:&quot;updaterName&quot;,&quot;value&quot;:&quot;p.nikulshin&quot;},{&quot;name&quot;:&quot;markdown&quot;,&quot;value&quot;:&quot;false&quot;},{&quot;name&quot;:&quot;wikified&quot;,&quot;value&quot;:&quot;true&quot;},{&quot;name&quot;:&quot;votes&quot;,&quot;value&quot;:&quot;0&quot;},{&quot;name&quot;:&quot;updated&quot;,&quot;value&quot;:&quot;1571058288597&quot;},{&quot;name&quot;:&quot;Priority&quot;,&quot;value&quot;:[&quot;Norm&quot;],&quot;valueId&quot;:[&quot;Normal&quot;],&quot;color&quot;:{&quot;bg&quot;:&quot;#e6f6cf&quot;,&quot;fg&quot;:&quot;#4da400&quot;}},{&quot;name&quot;:&quot;State&quot;,&quot;value&quot;:[&quot;Development&quot;],&quot;valueId&quot;:[&quot;Development&quot;],&quot;color&quot;:{&quot;bg&quot;:&quot;#ffee9c&quot;,&quot;fg&quot;:&quot;#b45f06&quot;}},{&quot;name&quot;:&quot;Исполнители&quot;,&quot;value&quot;:[{&quot;value&quot;:&quot;a.kryazhova&quot;,&quot;fullName&quot;:&quot;Анастасия Кряжова&quot;},{&quot;value&quot;:&quot;p.nikulshin&quot;,&quot;fullName&quot;:&quot;Павел Никульшин&quot;}]},{&quot;name&quot;:&quot;Story points&quot;,&quot;value&quot;:[&quot;13&quot;],&quot;valueId&quot;:[&quot;13&quot;],&quot;color&quot;:null}],&quot;comment&quot;:[{&quot;id&quot;:&quot;96-42253&quot;,&quot;author&quot;:&quot;i.markin&quot;,&quot;authorFullName&quot;:&quot;Игорь Маркин&quot;,&quot;issueId&quot;:&quot;ARGS-661&quot;,&quot;parentId&quot;:null,&quot;deleted&quot;:false,&quot;jiraId&quot;:null,&quot;text&quot;:&quot;&lt;div class=\&quot;wiki text common-markdown\&quot;&gt;&lt;p&gt;В статистике нужна инфа:&lt;/p&gt;\n&lt;ol class=\&quot;wiki-list0\&quot;&gt;\n&lt;li&gt;Кол-во заявок за сегодня&lt;/li&gt;\n&lt;li&gt;Аппрув рейт за сегодня (в стате не хватает флага аппрувд)&lt;/li&gt;\n&lt;li&gt;Кол-во звонков в обработке&lt;/li&gt;\n&lt;li&gt;Кол-во выданных сегодня залогов + беззалогов + сумма 2х&lt;/li&gt;\n&lt;li&gt;Сумма выданных за сегодня залогов+беззалогов +их сумма&lt;/li&gt;\n&lt;/ol&gt;\n&lt;/div&gt;&quot;,&quot;shownForIssueAuthor&quot;:false,&quot;created&quot;:1570520027435,&quot;updated&quot;:0,&quot;permittedGroup&quot;:null,&quot;markdown&quot;:true,&quot;replies&quot;:[]},{&quot;id&quot;:&quot;96-42784&quot;,&quot;author&quot;:&quot;p.nikulshin&quot;,&quot;authorFullName&quot;:&quot;Павел Никульшин&quot;,&quot;issueId&quot;:&quot;ARGS-661&quot;,&quot;parentId&quot;:null,&quot;deleted&quot;:false,&quot;jiraId&quot;:null,&quot;text&quot;:&quot;&lt;div class=\&quot;wiki text common-markdown\&quot;&gt;&lt;pre class=\&quot;wikicode prettyprint\&quot;&gt;&lt;code&gt;--сделки за текущий день\nselect \ncount(wd_rpt.id) as count_rpt,\ncount(wd_rpf.id) as count_rpf,\ncount(car_new.id) as count_new,\ncount(car_not_new.id) as count_not_new,\ncount(insurance_vkasko.id) as count_insurance_vkasko,\ncount(insurance_life.id) as count_insurance_life_rgsb,\ncount(insurance_service.id) as count_insurance_service_rgsb,\ncount(insurance_gap_kasko.id) as count_insurance_gap_kasko_rgsb,\nsum(wd_rpt.d_loan_amount) as sum_rpt,\nsum(wd_rpf.d_loan_amount) as sum_rpf,\nsum(ap_rgsb.amount) as sum_additional_products,\nsum(ap.amount) as sum_additional_products_not_rgsb,\nsum(insurance_vkasko.amount) as sum_insurance_vkasko,\nsum(insurance_life.amount) as sum_insurance_life,\nsum(insurance_service.amount) as sum_insurance_service,\nsum(insurance_gap_kasko.amount) as sum_insurance_gap_kasko\nfrom deals as deal\nleft join walker_data as wd_rpt on deal.request_id = wd_rpt.bpm_id and wd_rpt.d_program_id = 'rgsb_pledge_true'\nleft join walker_data as wd_rpf on deal.request_id = wd_rpf.bpm_id and wd_rpf.d_program_id = 'rgsb_pledge_false'\nleft join walker_data as car_new on deal.request_id = car_new.bpm_id and car_new.d_is_new is true\nleft join walker_data as car_not_new on deal.request_id = car_not_new.bpm_id and car_not_new.d_is_new is false\nleft join additional_products as ap_rgsb on deal.id = ap_rgsb.deal_id and ap_rgsb.is_rgsb is true\nleft join additional_products as ap on deal.id = ap.deal_id and ap.is_rgsb is false\nleft join additional_products as insurance_vkasko on deal.id = insurance_vkasko.deal_id and insurance_vkasko.type_id = 2 \nleft join additional_products as insurance_life on deal.id = insurance_life.deal_id and insurance_life.type_id = 1 and insurance_life.is_rgsb is true\nleft join additional_products as insurance_service on deal.id = insurance_service.deal_id and insurance_service.type_id = 5 and insurance_service.is_rgsb is true\nleft join additional_products as insurance_gap_kasko on deal.id = insurance_gap_kasko.deal_id and insurance_gap_kasko.type_id = 3 and insurance_gap_kasko.is_rgsb is true\nwhere deal.created::date = now()::date;\n\n--сделки по датам начиная с первого дня работы\nselect \nd::date as agg_date,\ncount(wd_rpt.id) as count_rpt,\ncount(wd_rpf.id) as count_rpf,\ncount(car_new.id) as count_new,\ncount(car_not_new.id) as count_not_new,\ncount(insurance_vkasko.id) as count_insurance_vkasko,\ncount(insurance_life.id) as count_insurance_life_rgsb,\ncount(insurance_service.id) as count_insurance_service_rgsb,\ncount(insurance_gap_kasko.id) as count_insurance_gap_kasko_rgsb,\nsum(wd_rpt.d_loan_amount) as sum_rpt,\nsum(wd_rpf.d_loan_amount) as sum_rpf,\nsum(ap_rgsb.amount) as sum_additional_products,\nsum(ap.amount) as sum_additional_products_not_rgsb,\nsum(insurance_vkasko.amount) as sum_insurance_vkasko,\nsum(insurance_life.amount) as sum_insurance_life,\nsum(insurance_service.amount) as sum_insurance_service,\nsum(insurance_gap_kasko.amount) as sum_insurance_gap_kasko\nfrom generate_series(\n(select min(created) as min_date from deals), \n(select max(created) as max_date from deals), \n'1 day'::interval) d\nleft join deals as deal on d::date = deal.created::date\nleft join walker_data as wd_rpt on deal.request_id = wd_rpt.bpm_id and wd_rpt.d_program_id = 'rgsb_pledge_true'\nleft join walker_data as wd_rpf on deal.request_id = wd_rpf.bpm_id and wd_rpf.d_program_id = 'rgsb_pledge_false'\nleft join walker_data as car_new on deal.request_id = car_new.bpm_id and car_new.d_is_new is true\nleft join walker_data as car_not_new on deal.request_id = car_not_new.bpm_id and car_not_new.d_is_new is false\nleft join additional_products as ap_rgsb on deal.id = ap_rgsb.deal_id and ap_rgsb.is_rgsb is true\nleft join additional_products as ap on deal.id = ap.deal_id and ap.is_rgsb is false\nleft join additional_products as insurance_vkasko on deal.id = insurance_vkasko.deal_id and insurance_vkasko.type_id = 2 \nleft join additional_products as insurance_life on deal.id = insurance_life.deal_id and insurance_life.type_id = 1 and insurance_life.is_rgsb is true\nleft join additional_products as insurance_service on deal.id = insurance_service.deal_id and insurance_service.type_id = 5 and insurance_service.is_rgsb is true\nleft join additional_products as insurance_gap_kasko on deal.id = insurance_gap_kasko.deal_id and insurance_gap_kasko.type_id = 3 and insurance_gap_kasko.is_rgsb is true\ngroup by agg_date\norder by agg_date desc;\n&lt;/code&gt;&lt;/pre&gt;\n&lt;/div&gt;&quot;,&quot;shownForIssueAuthor&quot;:false,&quot;created&quot;:1571058288600,&quot;updated&quot;:0,&quot;permittedGroup&quot;:null,&quot;markdown&quot;:true,&quot;replies&quot;:[]}],&quot;tag&quot;:[{&quot;value&quot;:&quot;Звезда&quot;,&quot;cssClass&quot;:&quot;c0&quot;}]}]" />
      </map>
    </option>
  </component>
</application>